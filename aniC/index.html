<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìºë¦­í„° C ì• ë‹ˆë©”ì´ì…˜</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
    <script>
        // ì´ë¯¸ì§€ ë³€ìˆ˜ ì„ ì–¸
        let earlyC, earlyCBag, sadC, sadCBag, darkBg, lightBg;
        let currentState = 'early';
        let imageX, imageY;
        let sadCStartFrame = 0;
        let happyCStartFrame = 0;
        let scaleFactor, offsetX, offsetY;

        function preload() {
            // ëª¨ë“  ì—ì…‹ í”„ë¦¬ë¡œë“œ
            earlyC    = loadImage('earlyC.png');
            earlyCBag = loadImage('earlyCBag.png');
            sadC      = loadImage('sadC.png');
            sadCBag   = loadImage('sadCBag.png');
            darkBg    = loadImage('darkBg.jpg');
            lightBg   = loadImage('lightBg.png');
        }

        function setup() {
            createCanvas(400, 600);
            // calculate scaling to preserve 600Ã—900 original ratio
            scaleFactor = min(width / 600, height / 600);
            offsetX     = (width  - 600 * scaleFactor) / 2;
            offsetY     = (height - 600 * scaleFactor) / 2;
            // set character center in original coordinate space
            imageX = 600 / 2;
            imageY = 600 / 2;
        }

        function draw() {
            // apply scaling and centering
            translate(offsetX, offsetY);
            scale(scaleFactor);

            push();
            imageMode(CENTER);
            background(255);
            drawCharacterC();
            drawButtons()
            pop();
        }

        // ì´ˆê¸° ìƒíƒœ ë“œë¡œì‰ í•¨ìˆ˜
        function drawEarlyC() {
            image(darkBg,    imageX, imageY, 600, 900);
            image(earlyC,    imageX, imageY, 600, 600);
            image(earlyCBag, imageX, imageY, 600, 600);
        }

        // í–‰ë³µí•œ ìƒíƒœ ë“œë¡œì‰ í•¨ìˆ˜ (ì²œì²œíˆ ì‘ì•„ì§€ê¸°) //ì•ìœ¼ë¡œ ë‚˜ì•„ê°€ê³  íŠ€ëŠ” íš¨ê³¼ aiì‚¬ìš©
        function drawHappyC() {
            image(lightBg, imageX - 2, imageY, 600, 900);

            let moveTime      = frameCount - happyCStartFrame;
            let delayDuration = 60;  // 1ì´ˆ(60í”„ë ˆì„)

            if (moveTime < delayDuration) {
                // ë¶ˆì´ ì¼œì§„ íš¨ê³¼ë§Œ ë³´ì—¬ì£¼ê³ , ìºë¦­í„°ëŠ” ì›€ì§ì´ì§€ ì•ŠìŒ
                image(earlyC,    imageX, imageY, 600, 600);
                image(earlyCBag, imageX, imageY, 600, 600);
            } else {
                let adjustedTime = moveTime - delayDuration;
                let scaleAmount  = max(0.3, 1 - adjustedTime * 0.003);
                let bounce       = sin(adjustedTime * 0.2) * 2 * scaleAmount;  // íŠ€ëŠ” íš¨ê³¼

                push();
                translate(imageX, imageY + bounce);
                scale(scaleAmount);
                image(earlyC,    0, 0, 600, 600);
                image(earlyCBag, 0, 0, 600, 600);
                pop();
            }
        }

        // ìŠ¬í”ˆ ìƒíƒœ ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜ (ê°€ë°©ì´ ë–¨ì–´ì§€ê³  ìƒíƒœ ë³€ê²½) //í”„ë ˆì„ë³„ ì• ë‹ˆë©”ì´ì…˜ aiì‚¬ìš©ìš©
        function drawSadC() {
            image(darkBg, imageX, imageY, 600, 900);

            let moveTime = frameCount - sadCStartFrame;

            if (moveTime < 60) {
                // ê°€ë°©ì´ ë–¨ì–´ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ (60í”„ë ˆì„)
                let bagY = imageY + moveTime * 3;
                image(earlyC,    imageX, imageY, 600, 600);
                image(earlyCBag, imageX, bagY,   600, 600);
            } else if (moveTime < 90) {
                // ë°”ë‹¥ì— ë–¨ì–´ì§„ ê°€ë°© ë³´ì—¬ì£¼ê¸° (30í”„ë ˆì„)
                image(earlyC,    imageX, imageY, 600, 600);
                image(sadCBag,   imageX, imageY, 600, 600);
            } else {
                // ìŠ¬í”ˆ ìºë¦­í„°ë¡œ ë³€ê²½
                image(sadC,    imageX, imageY, 600, 600);
                image(sadCBag, imageX, imageY, 600, 600);
            }
        }

        

function drawButtons() { //ë²„íŠ¼ ê·¸ë¦¬ëŠ” í•¨ìˆ˜//aiì‚¬ìš©ìš©

            textAlign(CENTER, CENTER)
  textSize(20)
  fill(255)
  text("ë‹¹ì‹ ì´ í–ˆë˜ ë§ì€?", width / 2+100, 100) // ë²„íŠ¼ ìœ„ìª½ì— ì¶œë ¥

    rectMode(CENTER)
    textAlign(CENTER, CENTER)
    textSize(20)
    noStroke()

    // ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼
    const btnW = 120
    const btnH = 50
    const btnRadius = 15

    // ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì²´í¬
    const isHoverHappy = mouseX > 150 - btnW/2 && mouseX < 150 + btnW/2 && mouseY > 100 - btnH/2 && mouseY < 100 + btnH/2
    const isHoverSad = mouseX > 450 - btnW/2 && mouseX < 450 + btnW/2 && mouseY > 100 - btnH/2 && mouseY < 100 + btnH/2

    // ğŸ˜Š ê¸ì • ë²„íŠ¼
    push();
    fill(isHoverHappy ? color(255, 230, 150) : color(255, 215, 100)) // hover ìƒ‰ìƒ
    drawingContext.shadowBlur = 10
    drawingContext.shadowColor = 'rgba(0,0,0,0.2)'
    drawingContext.shadowOffsetY = 2
    rect(150, 100, btnW, btnH, btnRadius)
    noStroke()
    fill(50)
    text("ğŸ˜Š ê¸ì •", 150, 100)
    pop()

    // ğŸ˜¢ ë¶€ì • ë²„íŠ¼
    push()
    fill(isHoverSad ? color(180, 220, 255) : color(130, 180, 255))// hover ìƒ‰ìƒ
    drawingContext.shadowBlur = 10
    drawingContext.shadowColor = 'rgba(0,0,0,0.2)'
    drawingContext.shadowOffsetY = 2
    rect(450, 100, btnW, btnH, btnRadius)
    noStroke()
    fill(30)
    text("ğŸ˜¢ ë¶€ì •", 450, 100)
    pop()
}

        function drawCharacterC() {
            
            if (currentState === 'early')      drawEarlyC();
            else if (currentState === 'happy') drawHappyC();
            else if (currentState === 'sad')   drawSadC();
        }

        // ë§ˆìš°ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ë§ //aiì‚¬ìš©ìš©
        function mousePressed() {
    // scale()ê³¼ translate() ì ìš© ì „ì˜ ì›ë˜ ì¢Œí‘œë¡œ ë˜ëŒë¦¼
    const scaledX = (mouseX - offsetX) / scaleFactor;
    const scaledY = (mouseY - offsetY) / scaleFactor;

    // ê¸ì • ë²„íŠ¼ í´ë¦­ (ë²„íŠ¼ ì¤‘ì‹¬: x=150, y=100, í¬ê¸°: 120x50)
    if (scaledX > 150 - 60 && scaledX < 150 + 60 && scaledY > 100 - 25 && scaledY < 100 + 25) {
        currentState = 'happy';
        happyCStartFrame = frameCount;
    }
    // ë¶€ì • ë²„íŠ¼ í´ë¦­ (ë²„íŠ¼ ì¤‘ì‹¬: x=450, y=100, í¬ê¸°: 120x50)
    else if (scaledX > 450 - 60 && scaledX < 450 + 60 && scaledY > 100 - 25 && scaledY < 100 + 25) {
        currentState = 'sad';
        sadCStartFrame = frameCount;
    }
    // ë‚˜ë¨¸ì§€ëŠ” ì´ˆê¸° ìƒíƒœ
    else {
        currentState = 'early';
    }
}
    </script>
</body>
</html>